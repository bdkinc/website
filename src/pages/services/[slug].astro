---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Navigation from "../../components/Navigation";
import { getNavigationData } from "@/lib/navigation-data";
import * as LucideIcons from "lucide-react";

export async function getStaticPaths() {
  const services = await getCollection("services");
  return services.map((service) => ({
    params: { slug: service.slug },
    props: { service },
  }));
}

const { service } = Astro.props;
const { Content } = await service.render();
const { servicesData, recentPosts } = await getNavigationData();

// Get the icon component dynamically
const IconComponent =
  (LucideIcons as any)[service.data.icon] || LucideIcons.Box;
---

<Layout title={`${service.data.title} - BDK Inc`}>
  <Navigation client:load services={servicesData} blogPosts={recentPosts} />
  <main class="relative min-h-screen -mt-16 pt-16">
    {/* Gradient background */}
    <div class="absolute inset-0 gradient-mesh"></div>

    {/* Circuit board pattern overlay */}
    <div class="absolute inset-0 opacity-40 circuit-overlay"></div>

    {/* Content */}
    <div class="relative z-10">
      <section class="py-24 px-4 sm:px-6 lg:px-8">
        <div class="max-w-7xl mx-auto">
          <!-- Hero Section -->
          <div class="text-center mb-16">
            <div
              class="inline-flex items-center justify-center p-4 rounded-2xl bg-linear-to-brr from-primary/10 to-secondary/10 mb-6"
            >
              <IconComponent className="w-12 h-12 text-primary" />
            </div>
            <h1 class="text-5xl md:text-6xl font-bold mb-6">
              <span
                class="bg-linear-to-br from-primary to-secondary bg-clip-text text-transparent"
              >
                {service.data.title}
              </span>
            </h1>
            <p class="text-xl text-muted-foreground max-w-3xl mx-auto">
              {service.data.description}
            </p>
          </div>

          <!-- Main Content -->
          <div class="space-y-12">
            <!-- Content from markdown -->
            <div class="prose prose-invert prose-lg max-w-5xl mx-auto">
              <Content />
            </div>

            <!-- CTA -->
            <div class="text-center glass rounded-2xl p-12">
              <h2 class="text-3xl md:text-4xl font-bold mb-4 text-foreground">
                Ready to Get Started?
              </h2>
              <p class="text-xl text-muted-foreground mb-8">
                Let's discuss how {service.data.title.toLowerCase()} can transform
                your business.
              </p>
              <a
                href="/contact"
                class="inline-flex items-center justify-center px-8 py-3 rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 transition-colors shadow-sm"
              >
                Contact Us Today
              </a>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>
</Layout>

